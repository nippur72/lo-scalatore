



   processor 6502



GETIN   = $ffe4     
CLRSCN  = $e55f     
PRNSTR  = $cb1e     
GOHOME  = $e581     
PRNINT  = $ddcd     
SCNKEY  = $ff9f     



CURSOR_PTR  = 209
JIFFY_CLOCK = 162
CRSRCOL     = 646



COLOR_BLACK   = 0
COLOR_WHITE   = 1
COLOR_RED     = 2
COLOR_CYAN    = 3
COLOR_MAGENTA = 4
COLOR_GREEN   = 5
COLOR_BLUE    = 6
COLOR_YELLOW  = 7



const SCREEN_COLS  = 22
const SCREEN_ROWS  = 23
const VIDEO_RAM    = 7680
const COLOR_RAM    = 38400
const COLOR_PAGE_OFFSET = ((COLOR_RAM - VIDEO_RAM) / 256)
const BASIC_RAM    = 4097
const RASTER       = $9004
const ROMCHAR      = 32768


    
MACRO cls
   jsr CLRSCN
END MACRO    
    
MACRO print
   lda #[[{1}_pos]%256]
   sta cursor_ptr
   lda #[[{1}_pos]/256]
   sta cursor_ptr+1 
   lda #[{1}%256]
   ldy #[{1}/256]
   jsr PRNSTR
   #ifdef VIC20 || C64 then jsr GOHOME         
END MACRO 
       
MACRO waitkey
   pha 
   txa : pha
   tya : pha
   do        
      jsr GETIN
   loop while zero
   pla : tay   
   pla : tax
   pla      
END MACRO

MACRO color const
   ld CRSRCOL, #{1}   
END MACRO

MACRO color mem
   ld CRSRCOL, {1}
END MACRO


   org BASIC_RAM


basic_row_0: byte [basic_row_1%256],[basic_row_1/256],[0%256],[0/256],153,34,147,34,58,151,53,49,44,49,57,50,58,151,53,50,44,50,57,58,151,53,53,44,49,57,50,58,151,53,54,44,50,57,58,151,51,54,56,54,57,44,50,53,53,58,151,51,54,56,55,56,44,49,53,58,151,51,54,56,55,57,44,50,53,0
basic_row_1: byte [basic_row_2%256],[basic_row_2/256],[1%256],[1/256],68,178,51,55,49,53,52,58,80,49,178,51,55,49,53,49,58,80,50,178,51,55,49,53,50,58,68,79,40,48,41,178,171,49,58,68,79,40,49,41,178,49,58,68,73,178,68,79,40,181,40,187,40,49,41,172,50,41,41,0
basic_row_2: byte [basic_row_3%256],[basic_row_3/256],[2%256],[2/256],65,36,178,34,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,157,148,62,34,58,134,66,40,49,49,41,58,71,178,51,48,55,50,48,0
basic_row_3: byte [basic_row_4%256],[basic_row_4/256],[3%256],[3/256],83,67,178,49,58,67,72,178,50,58,69,49,178,48,58,68,40,48,41,178,52,58,68,40,49,41,178,50,58,68,40,52,41,178,55,58,90,178,53,55,58,69,51,178,49,58,81,178,49,48,48,48,48,58,74,178,53,54,0
basic_row_4: byte [basic_row_5%256],[basic_row_5/256],[10%256],[10/256],141,49,48,48,58,151,51,54,56,54,57,44,50,53,53,58,69,52,178,48,58,69,53,178,50,0
basic_row_5: byte [basic_row_6%256],[basic_row_6/256],[15%256],[15/256],141,55,48,58,72,178,48,58,89,178,48,0
basic_row_6: byte [basic_row_7%256],[basic_row_7/256],[16%256],[16/256],83,178,56,49,52,51,170,181,40,187,40,49,41,172,50,48,41,58,139,194,40,83,170,50,50,41,178,54,50,176,194,40,83,41,178,53,57,167,49,54,0
basic_row_7: byte [basic_row_8%256],[basic_row_8/256],[17%256],[17/256],84,178,194,40,83,41,58,151,83,44,53,56,58,151,83,170,71,44,48,0
basic_row_8: byte [basic_row_9%256],[basic_row_9/256],[19%256],[19/256],86,178,55,55,49,50,170,66,40,89,41,58,87,178,54,50,58,68,79,178,68,79,40,181,40,187,40,49,41,172,50,41,41,0
basic_row_9: byte [basic_row_10%256],[basic_row_10/256],[20%256],[20/256],158,[[[read_joystick%100000]-[read_joystick%10000]]/10000+$30],[[[read_joystick%10000]-[read_joystick%1000]]/1000+$30],[[[read_joystick%1000]-[read_joystick%100]]/100+$30],[[[read_joystick%100]-[read_joystick%10]]/10+$30],[[[read_joystick%10]-[read_joystick%1]]/1+$30],58,145,194,40,49,41,137,51,53,44,50,54,44,50,56,44,51,49,44,51,51,0
basic_row_10: byte [basic_row_11%256],[basic_row_11/256],[21%256],[21/256],129,78,178,49,164,50,51,58,130,58,137,52,49,0
basic_row_11: byte [basic_row_12%256],[basic_row_12/256],[26%256],[26/256],139,194,40,83,170,50,50,41,178,90,167,151,83,44,84,58,151,83,170,71,44,68,40,84,171,74,41,58,83,178,83,170,50,50,58,137,52,48,0
basic_row_12: byte [basic_row_13%256],[basic_row_13/256],[27%256],[27/256],137,52,49,0
basic_row_13: byte [basic_row_14%256],[basic_row_14/256],[28%256],[28/256],68,73,178,171,49,58,139,194,40,83,170,50,49,41,179,54,50,167,151,83,44,84,58,151,83,170,71,44,68,40,84,171,74,41,58,83,178,83,171,49,58,137,52,48,0
basic_row_14: byte [basic_row_15%256],[basic_row_15/256],[29%256],[29/256],139,84,179,177,90,167,151,83,44,84,58,151,83,170,71,44,68,40,84,171,74,41,58,83,178,83,170,68,73,58,84,178,194,40,83,41,58,137,53,53,0
basic_row_15: byte [basic_row_16%256],[basic_row_16/256],[30%256],[30/256],137,52,49,0
basic_row_16: byte [basic_row_17%256],[basic_row_17/256],[31%256],[31/256],139,84,178,90,167,151,83,44,84,58,151,83,170,71,44,68,40,84,171,74,41,58,83,178,83,171,50,50,58,137,52,48,0
basic_row_17: byte [basic_row_18%256],[basic_row_18/256],[32%256],[32/256],137,52,49,0
basic_row_18: byte [basic_row_19%256],[basic_row_19/256],[33%256],[33/256],68,73,178,49,58,139,194,40,83,170,50,51,41,179,54,50,167,151,83,44,84,58,151,83,170,71,44,68,40,84,171,74,41,58,83,178,83,170,49,58,137,52,48,0
basic_row_19: byte [basic_row_20%256],[basic_row_20/256],[34%256],[34/256],137,50,57,0
basic_row_20: byte [basic_row_21%256],[basic_row_21/256],[35%256],[35/256],151,51,54,56,55,54,44,50,52,48,58,151,83,44,84,58,151,83,170,71,44,68,40,84,171,74,41,58,83,178,83,171,50,50,170,68,73,58,84,178,194,40,83,41,58,151,83,44,53,56,58,139,84,178,54,48,167,53,53,0
basic_row_21: byte [basic_row_22%256],[basic_row_22/256],[36%256],[36/256],139,194,40,83,170,50,50,41,178,54,48,167,83,83,178,83,83,170,49,48,48,48,58,141,50,48,48,0
basic_row_22: byte [basic_row_23%256],[basic_row_23/256],[37%256],[37/256],129,78,178,49,164,53,58,130,58,151,83,44,84,58,151,83,170,71,44,68,40,84,171,74,41,58,83,178,83,170,50,50,170,68,73,58,84,178,194,40,83,41,58,151,83,44,53,56,58,139,194,40,83,170,50,50,41,177,54,49,167,53,53,0
basic_row_23: byte [basic_row_24%256],[basic_row_24/256],[38%256],[38/256],151,83,170,71,44,48,58,151,51,54,56,55,54,44,48,58,137,52,49,0
basic_row_24: byte [basic_row_25%256],[basic_row_25/256],[40%256],[40/256],151,51,54,56,55,54,44,50,48,48,58,151,51,54,56,55,54,44,48,58,84,178,194,40,83,41,58,151,83,44,53,56,58,151,83,170,71,44,48,0
basic_row_25: byte [basic_row_26%256],[basic_row_26/256],[41%256],[41/256],139,84,178,54,49,167,83,83,178,83,83,170,49,53,48,58,141,50,48,48,58,72,178,72,170,49,58,84,178,54,50,58,139,72,178,49,54,167,54,52,0
basic_row_26: byte [basic_row_27%256],[basic_row_27/256],[42%256],[42/256],139,84,178,54,48,167,53,53,0
basic_row_27: byte [basic_row_28%256],[basic_row_28/256],[43%256],[43/256],141,57,56,0
basic_row_28: byte [basic_row_29%256],[basic_row_29/256],[45%256],[45/256],151,86,44,87,58,151,86,170,71,44,68,40,87,171,74,41,58,86,178,86,170,68,79,58,87,178,194,40,86,41,58,151,86,44,54,48,58,151,86,170,71,44,55,0
basic_row_29: byte [basic_row_30%256],[basic_row_30/256],[46%256],[46/256],139,68,79,178,50,50,175,194,40,86,170,50,50,41,178,53,54,167,68,79,178,68,79,40,181,40,187,40,49,41,172,50,41,41,58,137,52,56,0
basic_row_30: byte [basic_row_31%256],[basic_row_31/256],[47%256],[47/256],139,87,178,54,51,167,68,79,178,50,50,0
basic_row_31: byte [basic_row_32%256],[basic_row_32/256],[48%256],[48/256],139,87,178,53,56,167,53,53,0
basic_row_32: byte [basic_row_33%256],[basic_row_33/256],[49%256],[49/256],139,86,179,56,49,54,52,167,50,48,0
basic_row_33: byte [basic_row_34%256],[basic_row_34/256],[50%256],[50/256],89,178,89,170,49,58,139,89,178,49,50,167,53,53,0
basic_row_34: byte [basic_row_35%256],[basic_row_35/256],[51%256],[51/256],151,86,44,54,50,58,137,49,57,0
basic_row_35: byte [basic_row_36%256],[basic_row_36/256],[55%256],[55/256],151,51,54,56,55,54,44,48,58,83,79,178,50,53,48,58,139,84,178,54,48,167,84,178,87,0
basic_row_36: byte [basic_row_37%256],[basic_row_37/256],[56%256],[56/256],151,51,54,56,55,52,44,83,79,58,139,194,40,83,170,50,50,41,179,177,53,54,175,83,179,56,49,54,52,167,151,83,44,84,58,151,83,170,71,44,68,40,84,171,74,41,58,83,178,83,170,50,50,58,84,178,194,40,83,41,58,151,83,44,53,56,58,151,83,170,71,44,48,0
basic_row_37: byte [basic_row_38%256],[basic_row_38/256],[57%256],[57/256],129,78,178,49,164,49,55,58,130,58,83,79,178,83,79,171,53,58,139,83,79,177,49,53,48,167,53,54,0
basic_row_38: byte [basic_row_39%256],[basic_row_39/256],[58%256],[58/256],151,51,54,56,55,52,44,48,58,67,72,178,67,72,171,49,58,139,67,72,178,171,49,167,151,68,44,50,53,53,58,151,51,54,56,54,57,44,50,52,48,58,153,34,147,144,34,83,83,58,128,0
basic_row_39: byte [basic_row_40%256],[basic_row_40/256],[59%256],[59/256],141,50,48,48,58,151,86,44,87,58,151,86,170,71,44,68,40,87,171,74,41,58,89,178,89,170,49,58,139,87,178,53,56,167,151,86,44,84,58,151,86,170,71,44,68,40,84,171,74,41,0
basic_row_40: byte [basic_row_41%256],[basic_row_41/256],[60%256],[60/256],139,89,177,49,48,167,49,53,0
basic_row_41: byte [basic_row_42%256],[basic_row_42/256],[61%256],[61/256],139,83,177,56,49,54,51,167,151,83,44,84,58,137,49,54,0
basic_row_42: byte [basic_row_43%256],[basic_row_43/256],[62%256],[62/256],151,83,44,53,56,58,151,83,170,71,44,48,58,137,49,57,0
basic_row_43: byte [basic_row_44%256],[basic_row_44/256],[64%256],[64/256],139,89,178,49,49,167,54,55,0
basic_row_44: byte [basic_row_45%256],[basic_row_45/256],[65%256],[65/256],129,78,178,89,170,49,164,49,49,58,151,55,55,49,50,170,66,40,78,41,44,54,50,58,83,83,178,83,83,170,49,48,48,58,141,50,48,48,58,141,57,56,0
basic_row_45: byte [basic_row_46%256],[basic_row_46/256],[66%256],[66/256],151,51,54,56,55,55,44,50,53,48,58,129,77,178,50,52,48,164,50,53,48,58,151,51,54,56,55,54,44,77,58,130,58,151,51,54,56,55,54,44,48,58,151,51,54,56,55,55,44,48,58,130,0
basic_row_46: byte [basic_row_47%256],[basic_row_47/256],[67%256],[67/256],69,50,178,69,50,170,46,48,53,58,83,67,178,83,67,170,49,58,69,49,178,69,49,170,49,58,139,69,49,177,56,167,69,49,178,56,0
basic_row_47: byte [basic_row_48%256],[basic_row_48/256],[68%256],[68/256],137,49,53,0
basic_row_48: byte [basic_row_49%256],[basic_row_49/256],[69%256],[69/256],137,54,57,0
basic_row_49: byte [basic_row_50%256],[basic_row_50/256],[70%256],[70/256],153,34,147,156,34,59,58,129,78,178,49,164,50,49,58,153,65,36,58,130,58,153,65,36,34,19,34,58,66,36,178,34,62,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,34,0
basic_row_50: byte [basic_row_51%256],[basic_row_51/256],[71%256],[71/256],153,34,17,17,34,163,54,41,34,63,62,62,62,62,62,62,62,62,63,28,34,58,153,163,54,41,34,57,156,56,56,56,56,56,56,56,56,28,57,34,58,153,163,54,41,34,57,62,62,62,62,62,62,62,62,57,34,58,153,163,54,41,34,57,62,62,62,62,62,62,62,62,57,156,34,0
basic_row_51: byte [basic_row_52%256],[basic_row_52/256],[72%256],[72/256],129,78,178,49,164,51,58,153,66,36,34,17,17,17,17,34,58,130,58,153,66,36,34,19,34,59,58,151,56,49,56,53,44,54,50,0
basic_row_52: byte [basic_row_53%256],[basic_row_53/256],[73%256],[73/256],141,50,48,48,58,151,55,54,57,55,44,49,54,51,58,129,78,178,48,164,49,49,58,151,55,55,49,50,170,66,40,78,41,44,54,48,0
basic_row_53: byte [basic_row_54%256],[basic_row_54/256],[74%256],[74/256],151,55,55,49,50,170,66,40,78,41,170,71,44,55,58,130,58,129,78,178,55,56,51,52,164,56,49,54,52,169,49,49,48,58,139,78,178,56,49,54,52,167,56,48,0
basic_row_54: byte [basic_row_55%256],[basic_row_55/256],[75%256],[75/256],129,79,178,49,164,51,0
basic_row_55: byte [basic_row_56%256],[basic_row_56/256],[76%256],[76/256],82,178,78,170,49,170,181,40,187,40,49,41,172,50,48,41,58,139,194,40,82,41,179,177,53,54,167,55,54,0
basic_row_56: byte [basic_row_57%256],[basic_row_57/256],[77%256],[77/256],129,77,178,82,164,82,170,56,56,169,50,50,58,151,77,44,53,55,58,151,77,170,71,44,50,58,130,58,139,79,177,49,175,187,40,49,41,179,69,50,167,151,82,170,40,181,40,187,40,49,41,172,50,41,170,50,41,172,50,50,44,54,51,0
basic_row_57: byte [basic_row_58%256],[basic_row_58/256],[78%256],[78/256],139,187,40,49,41,179,46,53,175,194,40,82,171,50,50,41,178,54,50,167,151,82,171,50,50,44,54,51,0
basic_row_58: byte [basic_row_59%256],[basic_row_59/256],[79%256],[79/256],130,0
basic_row_59: byte [basic_row_60%256],[basic_row_60/256],[80%256],[80/256],129,79,178,49,164,69,49,0
basic_row_60: byte [basic_row_61%256],[basic_row_61/256],[81%256],[81/256],82,178,78,170,51,170,181,40,187,40,49,41,172,49,54,41,58,139,194,40,82,41,179,177,53,54,176,194,40,82,171,50,50,41,179,177,54,50,176,194,40,82,170,49,41,178,54,50,176,194,40,82,171,49,41,178,54,50,167,56,53,0
basic_row_61: byte [basic_row_62%256],[basic_row_62/256],[84%256],[84/256],151,82,44,54,50,58,151,82,171,50,50,44,54,51,0
basic_row_62: byte [basic_row_63%256],[basic_row_63/256],[85%256],[85/256],130,0
basic_row_63: byte [basic_row_64%256],[basic_row_64/256],[86%256],[86/256],129,79,178,49,164,52,0
basic_row_64: byte [basic_row_65%256],[basic_row_65/256],[87%256],[87/256],82,178,78,171,50,49,170,181,40,187,40,49,41,172,50,48,41,58,139,194,40,82,41,179,177,54,50,176,194,40,82,170,50,50,41,178,54,50,167,56,55,0
basic_row_65: byte [basic_row_66%256],[basic_row_66/256],[88%256],[88/256],151,82,44,54,49,58,151,82,170,71,44,48,58,130,58,130,0
basic_row_66: byte [basic_row_67%256],[basic_row_67/256],[89%256],[89/256],151,55,55,49,48,44,54,51,58,151,55,55,49,53,44,54,51,58,151,55,55,51,49,44,54,51,58,151,55,55,51,56,44,54,51,0
basic_row_67: byte [basic_row_68%256],[basic_row_68/256],[90%256],[90/256],129,78,178,55,56,49,50,164,56,49,52,50,169,49,49,48,58,151,78,44,54,51,58,130,58,129,78,178,55,56,51,51,164,56,49,54,51,169,49,49,48,58,151,78,44,54,51,58,130,58,142,0
basic_row_68: byte [basic_row_69%256],[basic_row_69/256],[98%256],[98/256],139,83,83,178,81,172,69,51,167,67,72,178,67,72,170,49,58,69,51,178,69,51,170,49,58,141,50,48,48,0
basic_row_69: byte [basic_row_70%256],[basic_row_70/256],[99%256],[99/256],142,0
basic_row_70: byte [basic_row_71%256],[basic_row_71/256],[100%256],[100/256],131,44,49,44,50,49,44,50,50,44,50,51,44,50,52,44,52,50,44,52,51,44,52,52,44,52,53,44,52,54,44,52,55,0
basic_row_71: byte [basic_row_72%256],[basic_row_72/256],[101%256],[101/256],131,50,53,53,44,50,53,53,44,49,53,51,44,49,48,50,44,49,48,50,44,49,53,51,44,50,53,53,44,50,53,53,44,49,57,53,44,50,53,53,44,50,53,53,44,49,57,53,44,49,57,53,44,50,53,53,44,50,53,53,44,49,57,53,44,54,48,44,54,48,44,50,53,44,50,53,53,44,49,56,56,0
basic_row_72: byte [basic_row_73%256],[basic_row_73/256],[102%256],[102/256],131,54,48,44,51,54,44,50,51,49,44,51,44,52,44,50,52,44,50,52,44,54,48,44,49,50,54,44,49,50,54,44,54,48,44,54,48,44,54,54,44,49,54,53,44,49,53,51,44,49,53,51,44,49,54,53,44,54,54,44,54,48,44,44,50,52,44,51,54,44,49,50,54,44,49,50,54,44,49,50,54,0
basic_row_73: byte [basic_row_74%256],[basic_row_74/256],[103%256],[103/256],131,49,50,54,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,0
basic_row_74: byte [basic_row_75%256],[basic_row_75/256],[109%256],[109/256],129,78,178,48,164,49,49,58,135,66,40,78,41,58,130,58,129,78,178,55,54,49,54,164,55,54,55,57,58,135,77,58,151,78,44,77,58,130,0
basic_row_75: byte [basic_row_76%256],[basic_row_76/256],[110%256],[110/256],142,0
200 print "{home}{rvon}tab(8-len(str$(ss)))ss;tab(14)ch;tab(17)sc
201 return
    basic end










LMCODE:

read_joystick:
   LDA #$00 : STA $01          
   LDA #$FF : STA $9122        
   LDA #$20 : BIT $911F        
   BNE JOY_DOWN                
   LDA #$01 : STA $01          
   RTS                         

JOY_DOWN:
   LDA #$08 : BIT $911F        
   BNE JOY_LEFT                
   LDA #$02 : STA $01          
   RTS                         

JOY_LEFT:
   LDA #$10 : BIT $911F        
   BNE JOY_UP                  
   LDA #$03 : STA $01          
   RTS

JOY_UP:
   LDA #$04 : BIT $911F        
   BNE JOY_RIGHT               
   STA $01                     
   RTS                         

JOY_RIGHT:
   LDA #$7F : STA $9122        
   LDA #$80 : BIT $9120        
   BNE JOY_NOTHING             
   LDA #$05 : STA $01          
JOY_NOTHING:
   RTS                         

